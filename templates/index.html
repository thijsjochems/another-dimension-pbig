<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Another Dimension - Beurs Stand</title>
    <link rel="stylesheet" href="/static/fonts.css">
    <style>
        /* === COLOR PALETTE === */
        :root {
            --color-bg: #001C0F;           /* Dark green background */
            --color-primary: #54FCBC;      /* Bright teal (text, accents) */
            --color-secondary: #DCFFED;    /* Light mint (subtle text) */
            --color-dark: #1E1E1E;         /* Dark gray (borders, shadows) */
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-body);
            background-color: var(--color-bg);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }
        
        .main-container {
            max-width: 1200px;
            width: 100%;
        }
        
        .header {
            text-align: center;
            margin-bottom: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        
        .robot-logo {
            width: 80px;
            height: 80px;
            opacity: 0.6;
            filter: drop-shadow(0 0 15px rgba(84, 252, 188, 0.3));
        }
        
        .robot-logo.flipped {
            transform: scaleX(-1);
        }
        
        h1 {
            font-size: 4rem;
            color: var(--color-primary);
            margin: 0;
            letter-spacing: 12px;
            text-transform: uppercase;
            text-shadow: 0 0 30px rgba(84, 252, 188, 0.4);
        }
        
        .split-container {
            position: relative;
            display: inline-block;
        }
        
        .split-top {
            display: block;
            background: var(--color-bg);
            clip-path: polygon(0 0, 100% 0, 100% 51%, 0 51%);
            transform: translateX(-3px);
        }
        
        .split-bottom {
            display: block;
            background: var(--color-bg);
            clip-path: polygon(0 51%, 100% 51%, 100% 100%, 0 100%);
            position: absolute;
            top: 0;
            left: 0;
        }
        
        .subtitle {
            text-align: center;
            color: var(--color-secondary);
            font-size: 1.4rem;
            margin-bottom: 60px;
            letter-spacing: 3px;
            opacity: 0.8;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
        }
        
        .service-button {
            background: rgba(84, 252, 188, 0.03);
            border: 2px solid rgba(84, 252, 188, 0.3);
            border-radius: 10px;
            padding: 50px 40px;
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--color-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-family: var(--font-body);
        }
        
        .service-button:hover {
            border-color: var(--color-primary);
            background: rgba(84, 252, 188, 0.08);
            box-shadow: 0 0 30px rgba(84, 252, 188, 0.3);
            transform: translateY(-5px);
        }
        
        .mystery-button {
            grid-column: 1 / -1;
            background: rgba(84, 252, 188, 0.05);
            border: 3px solid var(--color-primary);
            font-size: 2.5rem;
            padding: 60px 40px;
            box-shadow: 0 0 40px rgba(84, 252, 188, 0.2);
        }
        
        .mystery-button:hover {
            box-shadow: 0 0 60px rgba(84, 252, 188, 0.5);
            background: rgba(84, 252, 188, 0.1);
        }
        
        .scoreboard-button {
            grid-column: 1 / -1;
            background: rgba(84, 252, 188, 0.03);
            border: 2px solid rgba(84, 252, 188, 0.4);
            font-size: 1.6rem;
            padding: 30px 40px;
            box-shadow: 0 0 20px rgba(84, 252, 188, 0.15);
        }
        
        .scoreboard-button:hover {
            box-shadow: 0 0 40px rgba(84, 252, 188, 0.4);
            background: rgba(84, 252, 188, 0.06);
        }
        
        .icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px;
            display: block;
            stroke: var(--color-primary);
            fill: none;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: drop-shadow(0 0 10px rgba(84, 252, 188, 0.4));
            transition: all 0.3s ease;
        }
        
        .service-button:hover .icon {
            stroke: var(--color-primary);
            filter: drop-shadow(0 0 20px rgba(84, 252, 188, 0.6));
            transform: scale(1.1);
        }
        
        .footer-logo {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            max-width: 400px;
            width: 80%;
            opacity: 0.8;
            filter: drop-shadow(0 0 20px rgba(84, 252, 188, 0.3));
        }
        
        /* Custom cursor - REMOVED */
        
        @media (max-width: 768px) {
            .button-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2.5rem;
                letter-spacing: 6px;
            }
            
            .robot-logo {
                width: 50px;
                height: 50px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <img src="{{ url_for('static', filename='robot-mascot.png') }}" alt="Robot Detective" class="robot-logo">
            <h1>WHO 
                <span class="split-container">
                    <span class="split-top">KILLED</span>
                    <span class="split-bottom" aria-hidden="true">KILLED</span>
                </span> THE<br>POWER BI DASHBOARD?</h1>
            <img src="{{ url_for('static', filename='robot-mascot.png') }}" alt="Robot Detective" class="robot-logo flipped">
        </div>
        
        <div class="button-grid">
            <button class="service-button mystery-button" onclick="startGame()">
                <svg class="icon" viewBox="0 0 24 24">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                </svg>
                MURDER MYSTERY
            </button>
            
            <button class="service-button scoreboard-button" onclick="goToScoreboard()">
                <svg class="icon" viewBox="0 0 24 24" style="width: 45px; height: 45px;">
                    <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/>
                    <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/>
                    <path d="M4 22h16"/>
                    <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/>
                    <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/>
                    <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/>
                </svg>
                Leaderboard
            </button>
            
            <button class="service-button" onclick="showInfo('ai')">
                <svg class="icon" viewBox="0 0 24 24">
                    <rect x="3" y="11" width="18" height="10" rx="2"/>
                    <circle cx="12" cy="5" r="2"/>
                    <path d="M12 7v4"/>
                    <line x1="8" y1="16" x2="8" y2="16"/>
                    <line x1="16" y1="16" x2="16" y2="16"/>
                </svg>
                AI Automation
            </button>
            
            <button class="service-button" onclick="showInfo('ai-training')">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                    <path d="M2 17l10 5 10-5"/>
                    <path d="M2 12l10 5 10-5"/>
                </svg>
                AI Training
            </button>
            
            <button class="service-button" onclick="showInfo('portfolio')">
                <svg class="icon" viewBox="0 0 24 24">
                    <line x1="18" y1="20" x2="18" y2="10"/>
                    <line x1="12" y1="20" x2="12" y2="4"/>
                    <line x1="6" y1="20" x2="6" y2="14"/>
                </svg>
                Power BI Portfolio
            </button>
            
            <button class="service-button" onclick="showInfo('training')">
                <svg class="icon" viewBox="0 0 24 24">
                    <path d="M22 10v6M2 10l10-5 10 5-10 5z"/>
                    <path d="M6 12v5c3 3 9 3 12 0v-5"/>
                </svg>
                Power BI Training
            </button>
        </div>
    </div>
    
    <img src="{{ url_for('static', filename='AD-Sticker-Shape.png') }}" alt="Another Dimension" class="footer-logo">
    
    <script>
        // Auto-cleanup on page load
        window.addEventListener('DOMContentLoaded', () => {
            // Clean up any active games when returning to homepage
            fetch('/api/game/cleanup', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' }
            })
            .then(response => response.json())
            .then(data => {
                console.log('Cleanup result:', data);
            })
            .catch(error => {
                console.error('Cleanup error:', error);
            });
        });
        
        // Custom cursor movement
        document.addEventListener('mousemove', (e) => {
            const cursor = document.querySelector('body::after');
            document.body.style.setProperty('--mouse-x', e.clientX + 'px');
            document.body.style.setProperty('--mouse-y', e.clientY + 'px');
        });
        
        function showInfo(service) {
            console.log('Service clicked:', service);
            
            const messages = {
                portfolio: 'ðŸ“Š We bouwen Power BI dashboards die jouw data tot leven brengen!\n\nScan de QR code voor meer info.',
                training: 'ðŸŽ“ Word een Power BI expert met onze hands-on trainingen!\n\nScan de QR code voor meer info.',
                ai: 'ðŸ¤– Automatiseer je workflows met AI-integraties (n8n, Make, Zapier)!\n\nScan de QR code voor meer info.',
                'ai-training': 'ðŸ¤– Leer werken met AI tools in onze praktische trainingen!\n\nScan de QR code voor meer info.'
            };
            
            // Create modal/overlay instead of alert
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 28, 15, 0.95);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                backdrop-filter: blur(5px);
            `;
            
            const modal = document.createElement('div');
            modal.style.cssText = `
                background: rgba(84, 252, 188, 0.05);
                border: 3px solid #54FCBC;
                border-radius: 20px;
                padding: 60px;
                max-width: 600px;
                text-align: center;
                box-shadow: 0 0 60px rgba(84, 252, 188, 0.4);
            `;
            
            modal.innerHTML = `
                <div style="font-size: 4rem; margin-bottom: 30px;">${messages[service].split(' ')[0]}</div>
                <div style="color: #54FCBC; font-size: 1.5rem; line-height: 1.8; white-space: pre-line; margin-bottom: 40px;">
                    ${messages[service].substring(messages[service].indexOf(' '))}
                </div>
                <button style="
                    background: rgba(84, 252, 188, 0.1);
                    border: 2px solid #54FCBC;
                    color: #54FCBC;
                    padding: 20px 50px;
                    font-size: 1.3rem;
                    border-radius: 10px;
                    cursor: pointer;
                    text-transform: uppercase;
                    letter-spacing: 2px;
                    font-weight: 600;
                " onclick="this.parentElement.parentElement.remove()">
                    SLUITEN
                </button>
            `;
            
            overlay.appendChild(modal);
            document.body.appendChild(overlay);
            
            // Close on overlay click
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.remove();
                }
            });
        }
        
        function startGame() {
            console.log('Starting new game...');
            
            // First create a new game session via API
            fetch('/api/game/start', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    console.log('Game started successfully:', data);
                    // Save session code to localStorage
                    localStorage.setItem('sessionCode', data.session_code);
                    // Navigate to team reveal with session code
                    window.location.href = `/team-reveal/${data.session_code}`;
                } else {
                    console.error('Failed to start game:', data);
                    alert('Fout bij starten van het spel. Probeer opnieuw.');
                }
            })
            .catch(error => {
                console.error('Error starting game:', error);
                alert('Fout bij starten van het spel. Probeer opnieuw.');
            });
        }
        
        function goToScoreboard() {
            console.log('Navigating to scoreboard...');
            window.location.href = '/leaderboard';
        }

        // === NFC SCAN HANDLER ===
        let nfcBuffer = '';
        let nfcTimeout = null;

        document.addEventListener('keydown', (e) => {
            // Ignore if typing in input field
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                return;
            }

            // Clear timeout on new key
            clearTimeout(nfcTimeout);

            // Add character to buffer
            if (e.key.length === 1) {
                nfcBuffer += e.key;
            }

            // Set timeout to process buffer after 100ms of no input
            nfcTimeout = setTimeout(() => {
                if (nfcBuffer.length > 4) {
                    handleNFCScan(nfcBuffer);
                }
                nfcBuffer = '';
            }, 100);
        });

        function handleNFCScan(code) {
            console.log('NFC scan gedetecteerd:', code);
            
            // Check if it's the START code
            fetch('/api/game/scan', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ nfc_code: code })
            })
            .then(response => response.json())
            .then(data => {
                console.log('NFC scan result:', data);
                
                if (data.type === 'special' && data.data && data.data.code_type) {
                    const codeType = data.data.code_type;
                    console.log('Special NFC code type:', codeType);
                    
                    // Route based on code type
                    switch(codeType) {
                        case 'START':
                            console.log('START NFC gescand - nieuwe game starten');
                            startGame();
                            break;
                        case 'SCOREBOARD':
                            console.log('SCOREBOARD NFC gescand - naar leaderboard');
                            goToScoreboard();
                            break;
                        case 'EXIT':
                            console.log('EXIT NFC gescand - blijven op home');
                            // Already on home, do nothing
                            break;
                        case 'AI_AUTOMATION':
                            console.log('AI_AUTOMATION NFC gescand');
                            showInfo('ai');
                            break;
                        case 'AI_TRAINING':
                            console.log('AI_TRAINING NFC gescand');
                            showInfo('ai-training');
                            break;
                        case 'POWERBI_PORTFOLIO':
                            console.log('POWERBI_PORTFOLIO NFC gescand');
                            showInfo('portfolio');
                            break;
                        case 'POWERBI_TRAINING':
                            console.log('POWERBI_TRAINING NFC gescand');
                            showInfo('training');
                            break;
                        default:
                            console.log('Onbekend special code type:', codeType);
                    }
                }
            })
            .catch(error => {
                console.error('Error bij NFC scan:', error);
            });
        }
    </script>
</body>
</html>
